mid = eye(4);

c0 = ncon({mid,mid},{[-1,-3],[-2,-4]});
c1 = ncon({mid,mid},{[-1,-4],[-2,-3]});
c2 = ncon({mid,mid},{[-1,-2],[-3,-4]});

fnto16 = @(m) reshape(permute(m,[2,1,4,3]),16,16);

m0 = fn16to4(c0);
m1 = fn16to4(c1);
m2 = fn16to4(c2);

g0 = zeros(4);
g1 = g0; g2 = g0; g3 = g0;

g0(1,1)=1; g0(2,2)=1; g0(3,3)=-1; g0(4,4)=-1;
g1(1,4)=1; g1(2,3)=1; g1(3,2)=-1; g1(4,1)=-1;
g2(1,4)=-1j; g2(2,3)=1j; g2(3,2)=1j; g2(4,1)=-1j;
g3(1,3)=1; g3(2,4)=-1; g3(3,1)=-1; g3(4,2)=1;

fn_add_1 = @(m,y) ncon({m,y,y},{[-1,1,2,-4],[-2,1],[2,-3]});
fn_add = @(m,y1,y2) ncon({m,y1,y2},{[-1,1,2,-4],[-2,1],[2,-3]});

fn_add_2 = @(m,y) ncon({m,y,y},{[1,2,-3,-4],[-1,1],[-2,2]});
fn_add_3 = @(m,y) ncon({m,y,y},{[2,-2,-3,1],[-1,2],[1,-4]});
fn_add_4 = @(m,y) ncon({m,y,y},{[-1,-2,1,2],[1,-3],[2,-4]});
fn_add_heng = @(m,y) ncon({m,y,y},{[1,-2,3,-4],[-1,1],[3,-3]});
fn_add_heng2 = @(m,y1,y2) ncon({m,y1,y2},{[1,-2,3,-4],[-1,1],[3,-3]});
fn_add_shu = @(m,y) ncon({m,y,y},{[-1,2,-3,4],[-2,2],[4,-4]});
fn_add_shu2 = @(m,y1,y2) ncon({m,y1,y2},{[-1,2,-3,4],[-2,2],[4,-4]});